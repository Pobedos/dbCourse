%������ ���������� ����.���.2,

clc;
T=2.0;%��������� �������� ������������� �������
maxR=0;%��������� �������� ��������� ����. ��������
n=2.4;%���-�� �������� 1-�� �������
j=1;
SKO=0.1;%��� ����
k=1024;%���-�� ����� ������������� �������
d=0.1;
j=1;
for q = -d :0.001:d
   noise=randn(k+1,1)*SKO;
for i=1:k
       t(i)= (i-1)*(T/k);
       w(i) = exp(-(n*(t(i)-T/2)/T)^2); % ������� �������
       % ����� 1. ��� ������������� �������
      % x(i)= sin((2*pi*n*t(i))/T);
      % y(i)= sin((2*pi*n*(t(i)-T*q))/T);
       % ����� 2. ���  ������������� �������, �������������� �� ���������
       %���������������� ������� ��������
       %x(i) = sin((2*pi*n*t(i))/T)*w(i);
       %y(i) = sin((2*pi*n*(t(i)-T*q))/T)*w(i);
       % ����� 3. ���  ������������� �������,���� �� ������� ��������,
       %�������������� �� ��������� ���������������� ������� ��������
         x(i) = sin((2*pi*n*t(i))/T)*w(i);
         y(i) = sin((2*pi*n*(t(i)-T*q))/T)*w(i)+ noise(i);
       xy(i) = x(i)*y(i);%���������� ������� ���������������� ���������
end
int_xy=trapz(xy);
int_x2=trapz(power(x,2));
int_y2=trapz(power(y,2));
R(j) = int_xy/((sqrt(int_x2)*sqrt(int_y2)));
if (R(j)>maxR)
    maxR=R(j);
    maxQ = q;
end
j=j+1;
end
q = (-d:0.001:d);
figure
plot(q,R);
axis tight;
title('����������� ����. ����. �� �������������� ������ �� �������');
xlabel ('������������� �����');
ylabel('����������� ����������');
maxQ
m=11;%���-�� ����� �������������. ��������� ��������:11, 16, 31, 61, 101, 301
for s=1:m
 b(s)=(s-1)*((2*d/0.001)/(m-1))+1;
 R1(s)=R(b(s));
end
x=linspace(-d,d,m);% ������� �������� �� �������� �� ��� �
s=1:m;
figure
plot(x,R1)
axis tight
title('�� ������������');
xlabel('������������� �����');
ylabel('����������� ��������');
xx=1:m;
xi=1:0.1:m;
yint=interp1(xx,R1,xi,'spline');% ������-������������ ���� ����������
r1=yint;
apr=spaps(x,R1,0.000001);
figure
fnplt(apr)
axis tight
title('����� ������������');
xlabel('������������� �����');
ylabel('����������� ��������');

pause
close all;
clear;